{"version":3,"sources":["../../../src/components/modal/modal.js"],"names":["KEYCODES","ESCAPE","Modal","getDocument","props","document","portalElement","handleKeydown","e","keyCode","show","onClose","d","createElement","setAttribute","body","appendChild","closeOnEsc","addEventListener","setState","state","removeEventListener","remove","closeOnBlur","className","children","isCard","Children","only","type","toString","indexOf","showClose","cloneElement","createPortal","propTypes","bool","isRequired","func","element","object","string","defaultProps","Content","Card"],"mappings":"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","file":"modal.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport ModalContent from './components/content';\nimport ModalCard from './components/card';\n\nconst KEYCODES = {\n  ESCAPE: 27,\n};\n\nexport default class Modal extends PureComponent {\n  static propTypes = {\n    show: PropTypes.bool.isRequired,\n    onClose: PropTypes.func.isRequired,\n    closeOnEsc: PropTypes.bool,\n    closeOnBlur: PropTypes.bool,\n    showClose: PropTypes.bool,\n    children: PropTypes.element.isRequired,\n    document: PropTypes.object,\n    className: PropTypes.string,\n  }\n\n  static defaultProps = {\n    closeOnEsc: true,\n    showClose: true,\n    closeOnBlur: false,\n    className: '',\n    // Expose mount point for testing\n    document: null,\n  }\n\n  static Content = ModalContent\n  static Card = ModalCard\n\n  componentDidMount() {\n    const d = this.getDocument();\n    this.portalElement = d.createElement('div');\n    this.portalElement.setAttribute('class', 'modal-container');\n    d.body.appendChild(this.portalElement);\n    if (this.props.closeOnEsc) {\n      d.addEventListener('keydown', this.handleKeydown);\n    }\n    // eslint-disable-next-line\n    this.setState({ d });\n  }\n\n  componentWillUnmount() {\n    const { d } = this.state;\n    if (this.props.closeOnEsc) {\n      d.removeEventListener('keydown', this.handleKeydown);\n    }\n    this.portalElement.remove();\n  }\n\n  getDocument = () => {\n    if (this.props.document) {\n      return this.props.document;\n    }\n    if (typeof document !== 'undefined') {\n      return document;\n    }\n    return null;\n  }\n\n  portalElement = null;\n\n  handleKeydown = (e) => {\n    if (e.keyCode === KEYCODES.ESCAPE && this.props.show) {\n      this.props.onClose();\n    }\n  }\n\n  render() {\n    const { closeOnBlur, show, className } = this.props;\n    if (!this.getDocument() || !this.portalElement || !show) {\n      return null;\n    }\n    let { children } = this.props;\n    let isCard;\n    try {\n      isCard = React.Children.only(children).type.toString().indexOf('ModalCard') !== -1;\n    } catch (e) {\n      isCard = false;\n    }\n\n    const showClose = !isCard && this.props.showClose;\n\n    if (isCard) {\n      children = React.cloneElement(children, {\n        onClose: this.props.onClose,\n      });\n    }\n\n    return ReactDOM.createPortal(\n      <div className={classnames('modal', className, {\n        'is-active': show,\n      })}\n      >\n        <div role=\"presentation\" className=\"modal-background\" onClick={closeOnBlur ? this.props.onClose : null} />\n        {children}\n        {\n          showClose &&\n          <button onClick={this.props.onClose} className=\"modal-close is-large\" aria-label=\"close\" />}\n      </div>,\n      this.portalElement,\n    );\n  }\n}\n"]}