(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define("bulmaCarousel",b):a.bulmaCarousel=b()})(this,function(){"use strict";var a=Math.abs;class b{constructor(a=[]){this._listeners=new Map(a),this._middlewares=new Map}listenerCount(a){if(!this._listeners.has(a))return 0;const b=this._listeners.get(a);return b.length}removeListeners(a=null,b=!1){null===a?this._listeners=new Map:Array.isArray(a)?name.forEach(a=>this.removeListeners(a,b)):(this._listeners.delete(a),b&&this.removeMiddleware(a))}middleware(a,b){Array.isArray(a)?name.forEach(a=>this.middleware(a,b)):(!Array.isArray(this._middlewares.get(a))&&this._middlewares.set(a,[]),this._middlewares.get(a).push(b))}removeMiddleware(a=null){null===a?this._middlewares=new Map:Array.isArray(a)?name.forEach(a=>this.removeMiddleware(a)):this._middlewares.delete(a)}on(a,b,c=!1){if(Array.isArray(a))a.forEach(a=>this.on(a,b));else{a=a.toString();const d=a.split(/,|, | /);1<d.length?d.forEach(a=>this.on(a,b)):(!Array.isArray(this._listeners.get(a))&&this._listeners.set(a,[]),this._listeners.get(a).push({once:c,callback:b}))}}once(a,b){this.on(a,b,!0)}emit(a,b,c=!1){a=a.toString();let d=this._listeners.get(a),e=null,f=0,g=c;if(Array.isArray(d))for(d.forEach((h,i)=>{c||(e=this._middlewares.get(a),Array.isArray(e)?(e.forEach(c=>{c(b,(a=null)=>{null!==a&&(b=a),f++},a)}),f>=e.length&&(g=!0)):g=!0),g&&(h.once&&(d[i]=null),h.callback(b))});-1!==d.indexOf(null);)d.splice(d.indexOf(null),1)}}const c={size:1,autoplay:!1,delay:5e3,threshold:50,restraint:100,allowedTime:500},d={ready:"carousel:ready",slideBefore:"carousel:slide:before",slideAfter:"carousel:slide:after"},f=Symbol("onSwipeStart"),g=Symbol("onSwipeMove"),h=Symbol("onSwipeEnd");var i=!1;try{var e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(a){}class j extends b{constructor(a,b={}){if(super(),this.element="string"==typeof a?document.querySelector(a):a,!this.element)throw new Error("An invalid selector or non-DOM node has been provided.");this._clickEvents=["click"],this.options=Object.assign({},c,b),this.element.dataset.autoplay&&(this.options.autoplay=this.element.dataset.autoplay),this.element.dataset.delay&&(this.options.delay=this.element.dataset.delay),this.element.dataset.size&&!this.element.classList.contains("carousel-animate-fade")&&(this.options.size=this.element.dataset.size),this.element.classList.contains("carousel-animate-fade")&&(this.options.size=1),this.forceHiddenNavigation=!1,this[f]=this[f].bind(this),this[g]=this[g].bind(this),this[h]=this[h].bind(this),this.init()}static attach(a=".carousel, .hero-carousel",b={}){let c=[];const d=document.querySelectorAll(a);return[].forEach.call(d,a=>{setTimeout(()=>{c.push(new j(a,b))},100)}),c}init(){this.container=this.element.querySelector(".carousel-container"),this.items=this.element.querySelectorAll(".carousel-item"),this.currentItem={element:this.element,node:this.element.querySelector(".carousel-item.is-active"),pos:-1},this.currentItem.pos=this.currentItem.node?Array.from(this.items).indexOf(this.currentItem.node):-1,this.currentItem.node||(this.currentItem.node=this.items[0],this.currentItem.node.classList.add("is-active"),this.currentItem.pos=0),this.forceHiddenNavigation=1>=this.items.length;let a=this.element.querySelectorAll("img");[].forEach.call(a,a=>{a.setAttribute("draggable",!1)}),this._resize(),this._setOrder(),this._initNavigation(),this._bindEvents(),this.options.autoplay&&this._autoPlay(this.options.delay),this.emit(d.ready,this.currentItem)}_resize(){const a=window.getComputedStyle(this.element),b=parseInt(a.getPropertyValue("width"),10);if(1<this.options.size&&(this.offset=this.options.size>=Array.from(this.items).length?0:b/this.options.size,this.container.style.left=0-this.offset+"px",this.container.style.transform=`translateX(${this.offset}px)`,[].forEach.call(this.items,a=>{a.style.flexBasis=`${this.offset}px`})),this.element.classList.contains("carousel-animate-fade")&&this.items.length){let a=this.items[0].querySelector("img"),c=1;a.naturalWidth?(c=b/a.naturalWidth,this.container.style.height=a.naturalHeight*c+"px"):a.onload=()=>{c=b/a.naturalWidth,this.container.style.height=a.naturalHeight*c+"px"}}}_bindEvents(){this.previousControl&&this._clickEvents.forEach(a=>{this.previousControl.addEventListener(a,a=>{i||a.preventDefault(),this._autoPlayInterval&&(clearInterval(this._autoPlayInterval),this._autoPlay(this.optionsdelay)),this._slide("previous")},!!i&&{passive:!0})}),this.nextControl&&this._clickEvents.forEach(a=>{this.nextControl.addEventListener(a,a=>{i||a.preventDefault(),this._autoPlayInterval&&(clearInterval(this._autoPlayInterval),this._autoPlay(this.options.delay)),this._slide("next")},!!i&&{passive:!0})}),this.element.addEventListener("touchstart",this[f],!!i&&{passive:!0}),this.element.addEventListener("mousedown",this[f],!!i&&{passive:!0}),this.element.addEventListener("touchmove",this[g],!!i&&{passive:!0}),this.element.addEventListener("mousemove",this[g],!!i&&{passive:!0}),this.element.addEventListener("touchend",this[h],!!i&&{passive:!0}),this.element.addEventListener("mouseup",this[h],!!i&&{passive:!0})}destroy(){this.element.removeEventListener("touchstart",this[f],!!i&&{passive:!0}),this.element.removeEventListener("mousedown",this[f],!!i&&{passive:!0}),this.element.removeEventListener("touchmove",this[g],!!i&&{passive:!0}),this.element.removeEventListener("mousemove",this[g],!!i&&{passive:!0}),this.element.removeEventListener("touchend",this[h],!!i&&{passive:!0}),this.element.removeEventListener("mouseup",this[h],!!i&&{passive:!0})}[f](a){i||a.preventDefault(),a=a?a:window.event,a="changedTouches"in a?a.changedTouches[0]:a,this._touch={start:{time:new Date().getTime(),x:a.pageX,y:a.pageY},dist:{x:0,y:0}}}[g](a){i||a.preventDefault()}[h](a){i||a.preventDefault(),a=a?a:window.event,a="changedTouches"in a?a.changedTouches[0]:a,this._touch.dist={x:a.pageX-this._touch.start.x,y:a.pageY-this._touch.start.y},this._handleGesture()}_handleGesture(){const b=new Date().getTime()-this._touch.start.time;b<=this.options.allowedTime&&a(this._touch.dist.x)>=this.options.threshold&&a(this._touch.dist.y)<=this.options.restraint&&(0>this._touch.dist.x?this._slide("next"):this._slide("previous"))}_initNavigation(){this.previousControl=this.element.querySelector(".carousel-nav-left"),this.nextControl=this.element.querySelector(".carousel-nav-right"),(1>=this.items.length||this.forceHiddenNavigation)&&(this.container&&(this.container.style.left="0"),this.previousControl&&(this.previousControl.style.display="none"),this.nextControl&&(this.nextControl.style.display="none"))}_setOrder(){this.currentItem.node.style.order="1",this.currentItem.node.style.zIndex="1";let a,b,c,d=this.currentItem.node;for(a=b=2,c=Array.from(this.items).length;2<=c?b<=c:b>=c;a=2<=c?++b:--b)d=this._next(d),d.style.order=""+a%Array.from(this.items).length,d.style.zIndex="0"}_next(a){return a.nextElementSibling?a.nextElementSibling:this.items[0]}_previous(a){return a.previousElementSibling?a.previousElementSibling:this.items[this.items.length-1]}_slide(b="next"){this.items.length&&(this.oldItemNode=this.currentItem.node,this.emit(d.slideBefore,this.currentItem),"previous"===b?(this.currentItem.node=this._previous(this.currentItem.node),!this.element.classList.contains("carousel-animate-fade")&&(this.element.classList.add("is-reversing"),this.container.style.transform=`translateX(${-a(this.offset)}px)`)):(this.currentItem.node=this._next(this.currentItem.node),this.element.classList.remove("is-reversing"),this.container.style.transform=`translateX(${a(this.offset)}px)`),this.currentItem.node.classList.add("is-active"),this.oldItemNode.classList.remove("is-active"),this.element.classList.remove("carousel-animated"),setTimeout(()=>{this.element.classList.add("carousel-animated")},50),this._setOrder(),this.emit(d.slideAfter,this.currentItem))}_autoPlay(a=5e3){this._autoPlayInterval=setInterval(()=>{this._slide("next")},a)}}return j});