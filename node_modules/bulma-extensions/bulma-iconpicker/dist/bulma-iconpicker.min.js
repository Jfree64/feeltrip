var bulmaIconpicker=function(){'use strict';const a=['click','touchstart'];let b=function(a){return new Promise((b)=>{let c=document.createElement('link');if(c.type='text/css',c.rel='stylesheet',c.onload=function(){b()},c.href=a,!document.querySelector('link[href="'+a+'"]')){let a=document.querySelector('head');a.append(c)}})};class c{constructor(a,b={}){this.element=a,this.options=Object.assign({},{iconSets:[{name:'simpleLine',css:'https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.css',prefix:'icon-',displayPrefix:''},{name:'fontAwesome',css:'https://opensource.keycdn.com/fontawesome/4.7.0/font-awesome.min.css',prefix:'fa-',displayPrefix:'fa fa-icon'}]},b),this.icons=[],this.id='iconPicker'+new Date().getTime(),this.init()}init(){this.createModal(),this.createPreview(),this.options.iconSets.forEach((a)=>{b(a.css),fetch(a.css,{mode:'cors'}).then((a)=>a.text()).then((b)=>{this.icons[a.name]=this.parseCSS(b,a.prefix||'fa-',a.displayPrefix||''),this.modalSetTabs.querySelector('a').click();var c=new Event('touchstart');this.modalSetTabs.querySelector('a').dispatchEvent(c)})})}createPreview(){this.preview=document.createElement('div'),this.preview.className='icon is-large',this.preview.classList.add('iconpicker-preview');let b=document.createElement('i');if(b.className='iconpicker-icon-preview',this.element.value.length){let a=this.element.value.split(' ');a.forEach((a)=>{b.classList.add(a)})}this.preview.appendChild(b),a.forEach((a)=>{this.preview.addEventListener(a,(a)=>{a.preventDefault(),this.modal.classList.add('is-active')})}),this.element.parentNode.insertBefore(this.preview,this.element.nextSibling)}parseCSS(a,b='fa-',c=''){const d=new RegExp('\\.'+b+'([^\\.!:]*)::?before\\s*{\\s*content:\\s*["|\']\\\\[^\'|"]*["|\'];?\\s*}','g'),e=1;let f,g,h=[];for(;g=d.exec(a);)f={prefix:b,selector:b+g[e].trim(':'),name:this.ucwords(g[e]).trim(':'),filter:g[e].trim(':'),displayPrefix:c},h[g[e]]=f;return 0==Object.getOwnPropertyNames(this.icons).length&&console.warn('No icons found in CSS file'),h}ucwords(a){return(a+'').replace(/^(.)|\s+(.)/g,function(a){return a.toUpperCase()})}drawIcons(a){if(this.iconsList.innerHTML='',a)for(let[b,c]of Object.entries(a))this.iconsList.appendChild(this.createIconPreview(c))}createIconPreview(b,c='fa-'){let d=document.createElement('a');d.dataset.title=b.name,d.setAttribute('title',b.name),d.dataset.icon=b.selector,d.dataset.filter=b.filter;let e=document.createElement('i');return e.className='iconpicker-icon-preview',b.displayPrefix.length&&(c=b.displayPrefix.split(' '),c.forEach((a)=>{e.classList.add(a)})),e.classList.add(b.selector),d.appendChild(e),a.forEach((a)=>{d.addEventListener(a,(a)=>{a.preventDefault(),this.preview.innerHTML='',this.element.value=a.target.classList,this.preview.appendChild(a.target.cloneNode(!0)),this.modal.classList.remove('is-active')})}),d}createModal(){this.modal=document.createElement('div'),this.modal.className='modal',this.modal.classList.add('iconpicker-modal'),this.modal.id=this.id;let b=document.createElement('div');b.className='modal-background';let c=document.createElement('div');c.className='modal-card';let d=document.createElement('header');d.className='modal-card-head';let e=document.createElement('p');e.className='modal-card-title',e.innerHTML='iconPicker',this.modalHeaderSearch=document.createElement('input'),this.modalHeaderSearch.setAttribute('type','search'),this.modalHeaderSearch.setAttribute('placeholder','Search'),this.modalHeaderSearch.className='iconpicker-search',this.modalHeaderSearch.addEventListener('input',(a)=>{this.filter(a.target.value)});let f=document.createElement('button');if(f.className='delete',a.forEach((a)=>{f.addEventListener(a,(a)=>{a.preventDefault(),this.modal.classList.remove('is-active')})}),c.appendChild(d),this.modalBody=document.createElement('section'),this.modalBody.className='modal-card-body',1<=this.options.iconSets.length){let b=document.createElement('div');b.className='iconpicker-sets',b.classList.add('tabs'),this.modalSetTabs=document.createElement('ul'),this.options.iconSets.forEach((b)=>{let c=document.createElement('li'),d=document.createElement('a');d.dataset.iconset=b.name,d.innerHTML=b.name,a.forEach((a)=>{d.addEventListener(a,(a)=>{a.preventDefault();var b=this.modalSetTabs.querySelectorAll('.is-active');[].forEach.call(b,function(a){a.classList.remove('is-active')}),a.target.parentNode.classList.add('is-active'),this.drawIcons(this.icons[a.target.dataset.iconset]),this.filter(this.modalHeaderSearch.value)})}),c.appendChild(d),this.modalSetTabs.appendChild(c)}),b.appendChild(this.modalSetTabs),c.appendChild(b)}this.iconsList=document.createElement('div'),this.iconsList.className='iconpicker-icons',d.appendChild(e),d.appendChild(this.modalHeaderSearch),d.appendChild(f),this.modalBody.appendChild(this.iconsList),c.appendChild(this.modalBody),this.modal.appendChild(b),this.modal.appendChild(c),document.body.appendChild(this.modal)}filter(a=''){return''===a?void this.iconsList.querySelectorAll('[data-filter]').forEach((a)=>{a.classList.remove('is-hidden')}):void(this.iconsList.querySelectorAll('[data-filter]').forEach((a)=>{a.classList.remove('is-hidden')}),this.iconsList.querySelectorAll('[data-filter]:not([data-filter*="'+a+'"])').forEach((a)=>{a.classList.add('is-hidden')}))}}return document.addEventListener('DOMContentLoaded',function(){let a=document.querySelectorAll('[data-action="iconPicker"]'),b={};[].forEach.call(a,function(a){a.dataset.iconPicker||(a.dataset.iconPicker=new c(a,b))})}),c}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,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LEFBQUUsS0FBSSxDQUNsRyxBQUFFLEVBQUMsQUFBUyxVQUFDLEFBQUcsSUFBQyxBQUFXLEFBQUMsQUFBQyxZQUMvQixBQUFDLEFBQUMsR0FDSixBQUNGLFFBRUQsQUFBUSxVQUFDLEFBQWdCLGlCQUFFLEFBQWtCLG1CQUFFLFVBQVksQ0FDekQsR0FBSSxBQUFXLEdBQUcsQUFBUSxTQUFDLEFBQWdCLGlCQUFDLEFBQTRCLEFBQUMsQUFBQyxBQUMxRSw4QkFBSSxBQUFpQixFQUFHLEFBQUUsQUFBQyxHQUMzQixBQUFFLEdBQUMsQUFBTyxRQUFDLEFBQUksQUFBQyxBQUFXLE9BQUUsQUFBUyxBQUFVLFdBQUUsQUFDaEQsQUFBSSxDQUFDLEFBQVUsRUFBQyxBQUFPLFFBQUMsQUFBVSxBQUFFLGFBQ2xDLEFBQVUsRUFBQyxBQUFPLFFBQUMsQUFBVSxXQUFHLEFBQUksQUFBVSxBQUFDLEFBQVUsQUFBRSxBQUFpQixBQUFDLEFBQUMsQUFDL0UsV0FDRixBQUFDLEFBQUMsRUFDSixBQUFDLEFBQUMiLCJmaWxlIjoiYnVsbWEtaWNvbnBpY2tlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBNT1VTRV9FVkVOVFMgPSBbJ2NsaWNrJywgJ3RvdWNoc3RhcnQnXTtcblxubGV0IGZldGNoU3R5bGUgPSBmdW5jdGlvbih1cmwpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBsZXQgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICBsaW5rLnR5cGUgPSAndGV4dC9jc3MnO1xuICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnO1xuICAgIGxpbmsub25sb2FkID0gZnVuY3Rpb24oKSB7IHJlc29sdmUoKTsgfTtcbiAgICBsaW5rLmhyZWYgPSB1cmw7XG5cbiAgICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2xpbmtbaHJlZj1cIicgKyB1cmwgKyAnXCJdJykpIHtcbiAgICAgIGxldCBoZWFkU2NyaXB0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZCcpO1xuICAgICAgaGVhZFNjcmlwdC5hcHBlbmQobGluayk7XG4gICAgfVxuICB9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEljb25QaWNrZXIge1xuICBjb25zdHJ1Y3RvcihlbGVtZW50LCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgIGljb25TZXRzOiBbIHtcbiAgICAgICAgbmFtZTogJ3NpbXBsZUxpbmUnLCAvLyBOYW1lIGRpc3BsYXllZCBvbiB0YWJcbiAgICAgICAgY3NzOiAnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvc2ltcGxlLWxpbmUtaWNvbnMvMi40LjEvY3NzL3NpbXBsZS1saW5lLWljb25zLmNzcycsIC8vIENTUyB1cmwgY29udGFpbmluZyBpY29ucyBydWxlc1xuICAgICAgICBwcmVmaXg6ICdpY29uLScsIC8vIENTUyBydWxlcyBwcmVmaXggdG8gaWRlbnRpZnkgaWNvbnNcbiAgICAgICAgZGlzcGxheVByZWZpeDogJydcbiAgICAgIH0se1xuICAgICAgICBuYW1lOiAnZm9udEF3ZXNvbWUnLCAvLyBOYW1lIGRpc3BsYXllZCBvbiB0YWJcbiAgICAgICAgY3NzOiAnaHR0cHM6Ly9vcGVuc291cmNlLmtleWNkbi5jb20vZm9udGF3ZXNvbWUvNC43LjAvZm9udC1hd2Vzb21lLm1pbi5jc3MnLCAvLyBDU1MgdXJsIGNvbnRhaW5pbmcgaWNvbnMgcnVsZXNcbiAgICAgICAgcHJlZml4OiAnZmEtJywgLy8gQ1NTIHJ1bGVzIHByZWZpeCB0byBpZGVudGlmeSBpY29uc1xuICAgICAgICBkaXNwbGF5UHJlZml4OiAnZmEgZmEtaWNvbidcbiAgICAgIH0gXVxuICAgIH07XG5cblxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuICAgIHRoaXMuaWNvbnMgPSBbXTtcbiAgICB0aGlzLmlkID0gJ2ljb25QaWNrZXInICsgKCBuZXcgRGF0ZSApLmdldFRpbWUoKTtcbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5jcmVhdGVNb2RhbCgpO1xuICAgIHRoaXMuY3JlYXRlUHJldmlldygpO1xuXG4gICAgdGhpcy5vcHRpb25zLmljb25TZXRzLmZvckVhY2goIGljb25TZXQgPT4ge1xuICAgICAgZmV0Y2hTdHlsZShpY29uU2V0LmNzcyk7XG4gICAgICAvLyBQYXJzZSBDU1MgZmlsZSB0byBnZXQgYXJyYXkgb2YgYWxsIGF2YWlsYWJsZSBpY29uc1xuICAgICAgZmV0Y2goaWNvblNldC5jc3MsIHttb2RlOiAnY29ycyd9KVxuICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgIHJldHVybiByZXMudGV4dCgpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihjc3MgPT4ge1xuICAgICAgICAgIHRoaXMuaWNvbnNbaWNvblNldC5uYW1lXSA9IHRoaXMucGFyc2VDU1MoY3NzLCBpY29uU2V0LnByZWZpeCB8fCAnZmEtJywgaWNvblNldC5kaXNwbGF5UHJlZml4IHx8ICcnKTtcbiAgICAgICAgICB0aGlzLm1vZGFsU2V0VGFicy5xdWVyeVNlbGVjdG9yKCdhJykuY2xpY2soKTtcbiAgICAgICAgICB2YXIgdG91Y2hFdmVudCA9IG5ldyBFdmVudCgndG91Y2hzdGFydCcpO1xuICAgICAgICAgIHRoaXMubW9kYWxTZXRUYWJzLnF1ZXJ5U2VsZWN0b3IoJ2EnKS5kaXNwYXRjaEV2ZW50KHRvdWNoRXZlbnQpO1xuICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfSApO1xuICB9XG5cbiAgY3JlYXRlUHJldmlldygpIHtcbiAgICB0aGlzLnByZXZpZXcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aGlzLnByZXZpZXcuY2xhc3NOYW1lID0gJ2ljb24gaXMtbGFyZ2UnO1xuICAgIHRoaXMucHJldmlldy5jbGFzc0xpc3QuYWRkKCdpY29ucGlja2VyLXByZXZpZXcnKTtcbiAgICBsZXQgaWNvblByZXZpZXcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7XG4gICAgaWNvblByZXZpZXcuY2xhc3NOYW1lID0gJ2ljb25waWNrZXItaWNvbi1wcmV2aWV3JztcbiAgICBpZiAodGhpcy5lbGVtZW50LnZhbHVlLmxlbmd0aCkge1xuICAgICAgbGV0IGNsYXNzZXMgPSB0aGlzLmVsZW1lbnQudmFsdWUuc3BsaXQoJyAnKTtcbiAgICAgIGNsYXNzZXMuZm9yRWFjaCggY2xzID0+IHtcbiAgICAgICAgaWNvblByZXZpZXcuY2xhc3NMaXN0LmFkZCggY2xzICk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5wcmV2aWV3LmFwcGVuZENoaWxkKGljb25QcmV2aWV3KTtcblxuICAgIE1PVVNFX0VWRU5UUy5mb3JFYWNoKChldmVudCkgPT4ge1xuICAgICAgdGhpcy5wcmV2aWV3LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGUgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMucHJldmlldywgdGhpcy5lbGVtZW50Lm5leHRTaWJsaW5nKTtcbiAgfVxuXG4gIHBhcnNlQ1NTKCBjc3MsIHByZWZpeCA9ICdmYS0nLCBkaXNwbGF5UHJlZml4ID0gJycgKSB7XG4gICAgY29uc3QgaWNvblBhdHRlcm4gPSBuZXcgUmVnRXhwKCdcXFxcLicgKyBwcmVmaXggKyAnKFteXFxcXC4hOl0qKTo6P2JlZm9yZVxcXFxzKntcXFxccypjb250ZW50OlxcXFxzKltcInxcXCddXFxcXFxcXFxbXlxcJ3xcIl0qW1wifFxcJ107P1xcXFxzKn0nLCAnZycpO1xuICAgIGNvbnN0IGluZGV4ID0gMTtcbiAgICBsZXQgaWNvbnMgPSBbXSwgaWNvbiwgbWF0Y2g7XG5cbiAgICB3aGlsZSAoIG1hdGNoID0gaWNvblBhdHRlcm4uZXhlYyhjc3MpKSB7XG4gICAgICBpY29uID0ge1xuICAgICAgICBwcmVmaXg6IHByZWZpeCxcbiAgICAgICAgc2VsZWN0b3I6IHByZWZpeCArIG1hdGNoW2luZGV4XS50cmltKCc6JyksXG4gICAgICAgIG5hbWU6IHRoaXMudWN3b3JkcyhtYXRjaFtpbmRleF0pLnRyaW0oJzonKSxcbiAgICAgICAgZmlsdGVyOiBtYXRjaFtpbmRleF0udHJpbSgnOicpLFxuICAgICAgICBkaXNwbGF5UHJlZml4OiBkaXNwbGF5UHJlZml4XG4gICAgICB9XG4gICAgICBpY29uc1ttYXRjaFtpbmRleF1dID0gaWNvbjtcbiAgICB9XG5cbiAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcy5pY29ucykubGVuZ3RoID09IDApIHtcbiAgICAgIGNvbnNvbGUud2FybiggXCJObyBpY29ucyBmb3VuZCBpbiBDU1MgZmlsZVwiICk7XG4gICAgfVxuICAgIHJldHVybiBpY29ucztcbiAgfVxuXG4gIHVjd29yZHMgKHN0cikge1xuICAgIHJldHVybiAoc3RyICsgJycpLnJlcGxhY2UoL14oLil8XFxzKyguKS9nLCBmdW5jdGlvbiAoJDEpIHtcbiAgICAgIHJldHVybiAkMS50b1VwcGVyQ2FzZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZHJhd0ljb25zKGljb25TZXQpIHtcbiAgICB0aGlzLmljb25zTGlzdC5pbm5lckhUTUwgPSAnJztcblxuICAgIGlmIChpY29uU2V0KSB7XG4gICAgICBmb3IgKGxldCBbaWNvbk5hbWUsIGljb25dIG9mIE9iamVjdC5lbnRyaWVzKGljb25TZXQpKSB7XG4gICAgICAgIHRoaXMuaWNvbnNMaXN0LmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlSWNvblByZXZpZXcoaWNvbikpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNyZWF0ZUljb25QcmV2aWV3KGljb24sIHByZWZpeCA9ICdmYS0nKSB7XG4gICAgbGV0IGljb25MaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIGljb25MaW5rLmRhdGFzZXQudGl0bGUgPSBpY29uWyduYW1lJ107XG4gICAgaWNvbkxpbmsuc2V0QXR0cmlidXRlKCd0aXRsZScsIGljb25bJ25hbWUnXSk7XG4gICAgaWNvbkxpbmsuZGF0YXNldC5pY29uID0gaWNvblsnc2VsZWN0b3InXTtcbiAgICBpY29uTGluay5kYXRhc2V0LmZpbHRlciA9IGljb25bJ2ZpbHRlciddO1xuICAgIGxldCBpY29uUHJldmlldyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcbiAgICBpY29uUHJldmlldy5jbGFzc05hbWUgPSAnaWNvbnBpY2tlci1pY29uLXByZXZpZXcnO1xuICAgIGlmIChpY29uWydkaXNwbGF5UHJlZml4J10ubGVuZ3RoKSB7XG4gICAgICBwcmVmaXggPSBpY29uWydkaXNwbGF5UHJlZml4J10uc3BsaXQoJyAnKTtcbiAgICAgIHByZWZpeC5mb3JFYWNoKCBwZnggPT4ge1xuICAgICAgICBpY29uUHJldmlldy5jbGFzc0xpc3QuYWRkKCBwZnggKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpY29uUHJldmlldy5jbGFzc0xpc3QuYWRkKCBpY29uWydzZWxlY3RvciddICk7XG4gICAgaWNvbkxpbmsuYXBwZW5kQ2hpbGQoaWNvblByZXZpZXcpO1xuICAgIE1PVVNFX0VWRU5UUy5mb3JFYWNoKChldmVudCkgPT4ge1xuICAgICAgaWNvbkxpbmsuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgZSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5wcmV2aWV3LmlubmVySFRNTCA9ICcnO1xuICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSBlLnRhcmdldC5jbGFzc0xpc3Q7XG4gICAgICAgIHRoaXMucHJldmlldy5hcHBlbmRDaGlsZChlLnRhcmdldC5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGljb25MaW5rO1xuICB9XG5cbiAgY3JlYXRlTW9kYWwoKSB7XG4gICAgdGhpcy5tb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMubW9kYWwuY2xhc3NOYW1lID0gJ21vZGFsJztcbiAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5hZGQoICdpY29ucGlja2VyLW1vZGFsJyApO1xuICAgIHRoaXMubW9kYWwuaWQgPSB0aGlzLmlkO1xuICAgIGxldCBtb2RhbEJhY2tncm91bmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBtb2RhbEJhY2tncm91bmQuY2xhc3NOYW1lID0gJ21vZGFsLWJhY2tncm91bmQnO1xuICAgIGxldCBtb2RhbENhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBtb2RhbENhcmQuY2xhc3NOYW1lID0gJ21vZGFsLWNhcmQnO1xuXG4gICAgbGV0IG1vZGFsSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaGVhZGVyJyk7XG4gICAgbW9kYWxIZWFkZXIuY2xhc3NOYW1lID0gJ21vZGFsLWNhcmQtaGVhZCc7XG4gICAgbGV0IG1vZGFsSGVhZGVyVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgbW9kYWxIZWFkZXJUaXRsZS5jbGFzc05hbWUgPSAnbW9kYWwtY2FyZC10aXRsZSc7XG4gICAgbW9kYWxIZWFkZXJUaXRsZS5pbm5lckhUTUwgPSAnaWNvblBpY2tlcic7XG4gICAgdGhpcy5tb2RhbEhlYWRlclNlYXJjaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgdGhpcy5tb2RhbEhlYWRlclNlYXJjaC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnc2VhcmNoJyk7XG4gICAgdGhpcy5tb2RhbEhlYWRlclNlYXJjaC5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJywgJ1NlYXJjaCcpO1xuICAgIHRoaXMubW9kYWxIZWFkZXJTZWFyY2guY2xhc3NOYW1lID0gJ2ljb25waWNrZXItc2VhcmNoJztcbiAgICB0aGlzLm1vZGFsSGVhZGVyU2VhcmNoLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZSA9PiB7XG4gICAgICB0aGlzLmZpbHRlcihlLnRhcmdldC52YWx1ZSk7XG4gICAgfSk7XG4gICAgbGV0IG1vZGFsSGVhZGVyQ2xvc2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBtb2RhbEhlYWRlckNsb3NlLmNsYXNzTmFtZSA9ICdkZWxldGUnO1xuICAgIE1PVVNFX0VWRU5UUy5mb3JFYWNoKChldmVudCkgPT4ge1xuICAgICAgbW9kYWxIZWFkZXJDbG9zZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBlID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIG1vZGFsQ2FyZC5hcHBlbmRDaGlsZChtb2RhbEhlYWRlcik7XG5cbiAgICB0aGlzLm1vZGFsQm9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlY3Rpb24nKTtcbiAgICB0aGlzLm1vZGFsQm9keS5jbGFzc05hbWUgPSAnbW9kYWwtY2FyZC1ib2R5JztcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuaWNvblNldHMubGVuZ3RoID49IDEpIHtcbiAgICAgIGxldCBtb2RhbFNldHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIG1vZGFsU2V0cy5jbGFzc05hbWUgPSAnaWNvbnBpY2tlci1zZXRzJztcbiAgICAgIG1vZGFsU2V0cy5jbGFzc0xpc3QuYWRkKCd0YWJzJyk7XG4gICAgICB0aGlzLm1vZGFsU2V0VGFicyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgICB0aGlzLm9wdGlvbnMuaWNvblNldHMuZm9yRWFjaChpY29uU2V0ID0+IHtcbiAgICAgICAgbGV0IG1vZGFsU2V0VGFiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgbGV0IG1vZGFsU2V0VGFiTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgbW9kYWxTZXRUYWJMaW5rLmRhdGFzZXQuaWNvbnNldCA9IGljb25TZXQubmFtZTtcbiAgICAgICAgbW9kYWxTZXRUYWJMaW5rLmlubmVySFRNTCA9IGljb25TZXQubmFtZTtcbiAgICAgICAgTU9VU0VfRVZFTlRTLmZvckVhY2goKGV2ZW50KSA9PiB7XG4gICAgICAgICAgbW9kYWxTZXRUYWJMaW5rLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGUgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICB2YXIgYWN0aXZlTW9kYWxUYWJzID0gdGhpcy5tb2RhbFNldFRhYnMucXVlcnlTZWxlY3RvckFsbCgnLmlzLWFjdGl2ZScpO1xuICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGFjdGl2ZU1vZGFsVGFicywgZnVuY3Rpb24oYWN0aXZlTW9kYWxUYWIpIHtcbiAgICAgICAgICAgICAgYWN0aXZlTW9kYWxUYWIuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0ljb25zKHRoaXMuaWNvbnNbZS50YXJnZXQuZGF0YXNldC5pY29uc2V0XSk7XG4gICAgICAgICAgICB0aGlzLmZpbHRlcih0aGlzLm1vZGFsSGVhZGVyU2VhcmNoLnZhbHVlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIG1vZGFsU2V0VGFiLmFwcGVuZENoaWxkKG1vZGFsU2V0VGFiTGluayk7XG4gICAgICAgIHRoaXMubW9kYWxTZXRUYWJzLmFwcGVuZENoaWxkKG1vZGFsU2V0VGFiKTtcbiAgICAgIH0pO1xuICAgICAgbW9kYWxTZXRzLmFwcGVuZENoaWxkKHRoaXMubW9kYWxTZXRUYWJzKTtcbiAgICAgIG1vZGFsQ2FyZC5hcHBlbmRDaGlsZChtb2RhbFNldHMpO1xuICAgIH1cblxuICAgIHRoaXMuaWNvbnNMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5pY29uc0xpc3QuY2xhc3NOYW1lID0gJ2ljb25waWNrZXItaWNvbnMnO1xuXG4gICAgbW9kYWxIZWFkZXIuYXBwZW5kQ2hpbGQobW9kYWxIZWFkZXJUaXRsZSk7XG4gICAgbW9kYWxIZWFkZXIuYXBwZW5kQ2hpbGQodGhpcy5tb2RhbEhlYWRlclNlYXJjaCk7XG4gICAgbW9kYWxIZWFkZXIuYXBwZW5kQ2hpbGQobW9kYWxIZWFkZXJDbG9zZSk7XG5cbiAgICB0aGlzLm1vZGFsQm9keS5hcHBlbmRDaGlsZCh0aGlzLmljb25zTGlzdCk7XG4gICAgbW9kYWxDYXJkLmFwcGVuZENoaWxkKHRoaXMubW9kYWxCb2R5KTtcblxuICAgIHRoaXMubW9kYWwuYXBwZW5kQ2hpbGQobW9kYWxCYWNrZ3JvdW5kKTtcbiAgICB0aGlzLm1vZGFsLmFwcGVuZENoaWxkKG1vZGFsQ2FyZCk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLm1vZGFsKTtcbiAgfVxuXG4gIGZpbHRlcih2YWx1ZSA9ICcnKSB7XG4gICAgaWYgKHZhbHVlID09PSAnJykge1xuICAgICAgdGhpcy5pY29uc0xpc3QucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZmlsdGVyXScpLmZvckVhY2goIGVsID0+IHtcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaGlkZGVuJyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pY29uc0xpc3QucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZmlsdGVyXScpLmZvckVhY2goIGVsID0+IHtcbiAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWhpZGRlbicpO1xuICAgIH0pO1xuICAgIHRoaXMuaWNvbnNMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWZpbHRlcl06bm90KFtkYXRhLWZpbHRlcio9XCInICsgdmFsdWUgKyAnXCJdKScpLmZvckVhY2goIGVsID0+IHtcbiAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbicpO1xuICAgIH0pO1xuICB9XG59XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBsZXQgaWNvblBpY2tlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1hY3Rpb249XCJpY29uUGlja2VyXCJdJyk7XG4gIGxldCBpY29uUGlja2VyT3B0aW9ucyA9IHt9O1xuICBbXS5mb3JFYWNoLmNhbGwoaWNvblBpY2tlcnMsIGZ1bmN0aW9uKGljb25QaWNrZXIpIHtcbiAgICBpZiAoIWljb25QaWNrZXIuZGF0YXNldC5pY29uUGlja2VyKSB7XG4gICAgICBpY29uUGlja2VyLmRhdGFzZXQuaWNvblBpY2tlciA9IG5ldyBJY29uUGlja2VyKGljb25QaWNrZXIsIGljb25QaWNrZXJPcHRpb25zKTtcbiAgICB9XG4gIH0pO1xufSk7XG4iXX0=
